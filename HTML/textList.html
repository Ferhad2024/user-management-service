<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text Fayllar</title>
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg,#6e8efb,#a777e3);
    padding: 20px;
    min-height: 100vh;
}
h2 { text-align:center; color:#fff; margin-bottom:20px; }
#list .card {
    background:#fff;
    padding:15px;
    border-radius:10px;
    box-shadow:0 3px 10px rgba(0,0,0,0.2);
    margin-bottom:10px;
    cursor:pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}
#list .card:hover {
    transform: translateY(-3px);
    box-shadow:0 5px 15px rgba(0,0,0,0.3);
}
#content {
    white-space: pre-wrap;
    background:#eee;
    padding:15px;
    border-radius:10px;
    margin-top:20px;
}
</style>
</head>
<body>
<h2>Bütün Yüklənmiş Text Fayllar</h2>
<div id="list"></div>
<div id="content">Fayl məzmunu burada görünəcək...</div>

<script>
const API_BASE = "http://localhost:8080/app/dashboard/images";
let token = localStorage.getItem("accessToken"); // refreshToken yox, accessToken

async function fetchTexts(){
    let resp = await fetch(API_BASE, {
        headers: { "Authorization": "Bearer " + token }
    });
    if(!resp.ok){ alert("Fayllar yüklənmədi"); return; }
    let data = await resp.json();
    let listDiv = document.getElementById("list");
    listDiv.innerHTML = "";
    data.forEach(txt=>{
        let div = document.createElement("div");
        div.className = "card";
        div.innerText = txt.fileName + " (owner: " + txt.owner + ")";
        div.onclick = ()=>showContent(txt.id);
        listDiv.appendChild(div);
    });
}

async function showContent(id){
    let resp = await fetch(`${API_BASE}/${id}/content`, { // /content endpoint olmalıdır backenddə
        headers: { "Authorization": "Bearer " + token }
    });
    if(!resp.ok){ alert("Content oxunmadı"); return; }
    let data = await resp.text();
    document.getElementById("content").innerText = data;
}

fetchTexts();
</script>
</body>
</html>
